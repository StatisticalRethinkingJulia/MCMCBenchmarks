<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · StatisticalRethinkingJulia/MCMCBenchmarks.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>StatisticalRethinkingJulia/MCMCBenchmarks.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../purpose/">Purpose</a></li><li><a class="toctext" href="../design/">Design</a></li><li class="current"><a class="toctext" href>Functions</a><ul class="internal"><li><a class="toctext" href="#Sampler-Structs-1">Sampler Structs</a></li><li><a class="toctext" href="#Functions-1">Functions</a></li><li><a class="toctext" href="#Results-DataFrame-1">Results DataFrame</a></li></ul></li><li><a class="toctext" href="../example/">Example</a></li><li><a class="toctext" href="../benchmarks/">Benchmark Results</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Functions</a></li></ul><a class="edit-page" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/master/docs/src/functions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Functions</span><a class="fa fa-bars" href="#"></a></div></header><h2><a class="nav-anchor" id="Sampler-Structs-1" href="#Sampler-Structs-1">Sampler Structs</a></h2><p>Each sampler is associated with a MCMC sampler struct, which is a subtype of MCMCSampler. In MCMCBenchmarks, we define subtypes of MCMCSampler for three popular NUTS MCMC samplers in Julia: <a href="https://github.com/StanJulia/CmdStan.jl">CmdStan</a>, <a href="https://github.com/TuringLang/AdvancedHMC.jl">AdvancedHMC</a> via <a href="https://turing.ml">Turing</a>, and <a href="https://github.com/tpapp/DynamicHMC.jl">DynamicHMC</a>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.MCMCSampler" href="#MCMCBenchmarks.MCMCSampler"><code>MCMCBenchmarks.MCMCSampler</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>Abstract MCMC sampler type</p></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L2-L4">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.CmdStanNUTS" href="#MCMCBenchmarks.CmdStanNUTS"><code>MCMCBenchmarks.CmdStanNUTS</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MCMC sampler struct for CmdStan NUTS</p><ul><li><code>model</code>: model configuration</li><li><code>dir</code>: probject directory</li><li><code>id</code>: a unique identifier for each instance of CmdStan in parallel applications</li><li><code>name</code>: a unique identifer given to each sampler</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L22-L29">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.AHMCNUTS" href="#MCMCBenchmarks.AHMCNUTS"><code>MCMCBenchmarks.AHMCNUTS</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MCMC sampler struct for AdvancedHMC NUTS</p><ul><li><code>model</code>: model function that accepts data</li><li><code>config</code>: sampler configution settings</li><li><code>name</code>: a unique identifer given to each sampler</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L7-L13">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.DHMCNUTS" href="#MCMCBenchmarks.DHMCNUTS"><code>MCMCBenchmarks.DHMCNUTS</code></a> — <span class="docstring-category">Type</span>.</div><div><div><p>MCMC sampler struct for DynamicHMC NUTS</p><ul><li><code>model</code>: model function that accepts data</li><li><code>config</code>: sampler configution settings</li><li><code>name</code>: a unique identifer given to each sampler</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L39-L45">source</a></section><h2><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h2><h3><a class="nav-anchor" id="Top-level-Benchmark-Routines-1" href="#Top-level-Benchmark-Routines-1">Top-level Benchmark Routines</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.benchmark" href="#MCMCBenchmarks.benchmark"><code>MCMCBenchmarks.benchmark</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Runs the benchmarking procedure and returns the results</p><ul><li><code>samplers</code>: a tuple of samplers or a single sampler object</li><li><code>simulate</code>: model simulation function with keyword Nd</li><li><code>Nreps</code>: number of times the benchmark is repeated for each factor combination</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L90-L96">source</a></section><p>julia benchmark!(samplers,results,csr̂,simulate,Nreps,chains;kwargs...)</p><p>benchmark!(sampler::T,results,csr̂,simulate,Nreps,chains;kwargs...) where {T&lt;:MCMCSampler}</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.pbenchmark" href="#MCMCBenchmarks.pbenchmark"><code>MCMCBenchmarks.pbenchmark</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Runs the benchmarking procedure defined in benchmark in parallel and returns the results</p><ul><li><code>samplers</code>: a tuple of samplers or a single sampler object</li><li><code>simulate</code>: model simulation function with keyword Nd</li><li><code>Nreps</code>: number of times the benchmark is repeated for each factor combination</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L106-L113">source</a></section><p>julia pbenchmark(samplers,simulate,Nreps;kwargs...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.benchmark!" href="#MCMCBenchmarks.benchmark!"><code>MCMCBenchmarks.benchmark!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Primary function that performs mcmc benchmark repeatedly on a set of samplers and records the results.</p><ul><li>&#39;sampler&#39;: tuple of sampler objects</li><li><code>results</code>: DataFrame containing benchmark results</li><li><code>csr̂</code>: cross sampler r̂</li><li><code>simulate</code>: data generating function</li><li><code>Nreps</code>: number of repetitions for a given set of simulation parameters. Default = 100</li><li><code>kwargs</code>: optional keyword arguments that are passed to modifyConfig!, updateResults! and</li></ul><p>runSampler, providing flexibility in benchmark simulations.</p></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L54-L64">source</a></section><p>julia benchmark!(samplers,results,csr̂,simulate,Nreps,chains;kwargs...)</p><pre><code class="language-none"></code></pre><h3><a class="nav-anchor" id="Overloaded-Benchmark-Functions-1" href="#Overloaded-Benchmark-Functions-1">Overloaded Benchmark Functions</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.modifyConfig!" href="#MCMCBenchmarks.modifyConfig!"><code>MCMCBenchmarks.modifyConfig!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Modifies MCMC sampler configuration, including number of samples, target acceptance rate and others depending on the specific sampler.</p><ul><li><code>s</code>: sampler object</li><li><code>Nsamples</code>: total number of MCMC samples</li><li><code>Nadapt</code>: number of adaption samples during warm up</li><li><code>delta</code>: target acceptance rate.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L210-L217">source</a></section><p>julia modifyConfig!(s::AHMCNUTS;Nsamples,Nadapt,delta,kwargs...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.updateResults!" href="#MCMCBenchmarks.updateResults!"><code>MCMCBenchmarks.updateResults!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Update the results DataFrame on each iteration</p><ul><li><code>s</code>: MCMC sampler object</li><li><code>performance</code>: includes MCMC Chain, execution time, and memory measurements</li><li><code>results</code>: DataFrame containing benchmark results</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L144-L149">source</a></section><p>julia updateResults!(s::CmdStanNUTS,performance,results;kwargs...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.runSampler" href="#MCMCBenchmarks.runSampler"><code>MCMCBenchmarks.runSampler</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Extracts model and configuration from sampler object and performs parameter estimation</p><ul><li><code>s</code>: sampler object</li><li><code>data</code>: data for benchmarking</li><li><code>Nchains</code>: number of chains ran serially. Default =  1</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/core_benchmarking.jl#L122-L128">source</a></section><p>julia  runSampler(s::AHMCNUTS,data;kwargs...)</p><pre><code class="language-none"></code></pre><h3><a class="nav-anchor" id="Helper-Functions-1" href="#Helper-Functions-1">Helper Functions</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.addPerformance!" href="#MCMCBenchmarks.addPerformance!"><code>MCMCBenchmarks.addPerformance!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Adds performance metrics to benchmark results, which include runtime, memory allocations in MB, garbage collection time, percent of time spent in garbage collection, and the number of memory allocations</p><ul><li><code>df</code>: the dataframe to which performance metrics are added</li><li><code>p</code>: a collection of performance metrics including run time,</li></ul><p>memory allocations and garbage collection time</p></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/helper_functions.jl#L37-L44">source</a></section><p>julia addPerformance!(df,p)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.addKW!" href="#MCMCBenchmarks.addKW!"><code>MCMCBenchmarks.addKW!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Adds keyword arguments to the results DataFrame</p><ul><li><code>df</code>: DataFrame containing benchmark results for single iteration</li><li><code>kwargs</code>: keyword arguments</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/helper_functions.jl#L26-L30">source</a></section><p>julia addKW!(df;kwargs...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.addChainSummary!" href="#MCMCBenchmarks.addChainSummary!"><code>MCMCBenchmarks.addChainSummary!</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Adds chain summary (e.g. rhat,ess) to newDF for each parameter.</p><ul><li><code>newDF</code>: dataframe that collects results on an iteration</li><li><code>chn</code>: chain for given iteration</li><li><code>df</code>: df of chain results</li><li><code>col</code>: name of column</li></ul><p>e.g. If col = :ess, and parameters are mu and sigma, the new columns will be mu<em>ess and sigma</em>ess and will contain their respective ess values</p></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/helper_functions.jl#L68-L77">source</a></section><p>julia addChainSummary!(newDF,chn,df,col)</p><pre><code class="language-none"></code></pre><pre><code class="language-none">addHPD!
</code></pre><p>julia addHPD!(newDF,chain)</p><pre><code class="language-none"></code></pre><pre><code class="language-none">addMeans!
</code></pre><p>julia addMeans!(newDF,df)</p><pre><code class="language-none"></code></pre><h3><a class="nav-anchor" id="Plotting-1" href="#Plotting-1">Plotting</a></h3><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.plotdensity" href="#MCMCBenchmarks.plotdensity"><code>MCMCBenchmarks.plotdensity</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Plots a desnity of a distribution for a selected metric (e.g. effective sample size)</p><ul><li><code>df</code>: dataframe of results</li><li><code>metric</code>: name of metric, such as :ess for effective sample size</li><li><code>group</code>: a tuple of grouping factors, e.g. (:sampler,:Nd)</li><li><code>save</code>: save=true saves each plot</li><li><code>figfmt</code>: figure format</li><li><code>dir</code>: directory of saved plot. Default pwd.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/plotting.jl#L1-L9">source</a></section><p>julia plotdensity(df::DataFrame,metric::Symbol,group=(:sampler,);save=false,     figfmt=&quot;pdf&quot;,dir=&quot;&quot;,options...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.plotsummary" href="#MCMCBenchmarks.plotsummary"><code>MCMCBenchmarks.plotsummary</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Plots a summary of a metric computed according to a function, func. func defaults to the mean.</p><ul><li><code>df</code>: dataframe of results</li><li><code>xvar</code>: variable assigned to x-axis</li><li><code>metric</code>: name of metric, such as :ess for effective sample size</li><li><code>group</code>: a tuple of grouping factors, e.g. (:sampler,:Nd)</li><li><code>save</code>: save=true saves each plot</li><li><code>figfmt</code>: figure format</li><li>func: a function used to summarize results. Default mean</li><li><code>dir</code>: directory of saved plot. Default pwd.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/plotting.jl#L25-L35">source</a></section><p>julia plotsummary(df::DataFrame,xvar::Symbol,metric::Symbol,group=(:sampler,);save=false,     figfmt=&quot;pdf&quot;,func=mean,dir=&quot;&quot;,options...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.plotscatter" href="#MCMCBenchmarks.plotscatter"><code>MCMCBenchmarks.plotscatter</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Generates a scatter plot to visualize the relationship between two benchmarking metrics.</p><ul><li><code>df</code>: dataframe of results</li><li><code>xvar</code>: variable assigned to x-axis</li><li><code>metric</code>: name of metric, such as :ess for effective sample size</li><li><code>group</code>: a tuple of grouping factors, e.g. (:sampler,:Nd)</li><li><code>save</code>: save=true saves each plot</li><li><code>figfmt</code>: figure format</li><li>func: a function used to summarize results. Default mean</li><li><code>dir</code>: directory of saved plot. Default pwd.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/plotting.jl#L53-L64">source</a></section><p>julia plotscatter(df::DataFrame,xvar::Symbol,metric::Symbol,group=(:sampler,);save=false,     figfmt=&quot;pdf&quot;,func=mean,dir=&quot;&quot;,options...)</p><pre><code class="language-none"></code></pre><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="MCMCBenchmarks.plotrecovery" href="#MCMCBenchmarks.plotrecovery"><code>MCMCBenchmarks.plotrecovery</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Generates a plot to compare the estimated parameters to true parameter values used to generate simulated data.</p><ul><li><code>df</code>: dataframe of results</li><li><code>parms</code>: namedtuple of parameter names and true values</li><li><code>group</code>: a tuple of grouping factors, e.g. (:sampler,:Nd)</li><li><code>save</code>: save=true saves each plot</li><li><code>figfmt</code>: figure format</li><li>func: a function used to summarize results. Default mean</li><li><code>dir</code>: directory of saved plot. Default pwd.</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/StatisticalRethinkingJulia/MCMCBenchmarks.jl/blob/a7c36cef01e9c65730360d07596ef15c8765f0b0/src/plotting.jl#L80-L90">source</a></section><p>julia plotrecovery(df::DataFrame,parms,group=(:sampler,);save=false,     figfmt=&quot;pdf&quot;,dir=&quot;&quot;,options...)</p><p><span>$$</span>`</p><h2><a class="nav-anchor" id="Results-DataFrame-1" href="#Results-DataFrame-1">Results DataFrame</a></h2><footer><hr/><a class="previous" href="../design/"><span class="direction">Previous</span><span class="title">Design</span></a><a class="next" href="../example/"><span class="direction">Next</span><span class="title">Example</span></a></footer></article></body></html>
